#include <16F877A.h>
#device ADC=16

#FUSES NOWDT                    //No Watch Dog Timer
#FUSES NOBROWNOUT               //No brownout reset
#FUSES NOLVP    
#FUSES NOPUT                    //No Power Up Timer
#FUSES NOPROTECT                //Code not protected from reading
#FUSES NODEBUG                  //No Debug mode for ICD
#FUSES BROWNOUT                 //Reset when brownout detected
#FUSES NOLVP   
#FUSES NOCPD                    //No EE protection
#FUSES NOWRT                    //Program memory not write protected
#FUSES RESERVED  

//No low voltage prgming, B3(PIC16) or B5(PIC18) used for I/O

#use delay(crystal=20000000)

#define LED PIN_None
#define DELAY 1000

int vermelhoCar = PIN_D2; //Define vermelhoCar no pino D2 - vermelho dos carros
int amareloCar = PIN_D1; //Define amareloCar no pino D1 - amarelo dos carros
int verdeCar = PIN_D0; //Define verdeCar no pino D0 - verde dos carros
int vermelhoPed = PIN_D7; //Define vermelhoPed no pino D7 - vermelho dos pedestres
int verdePed = PIN_D6; //Define verdePed no pino D6 - verde dos pedestres
int buttonPin = PIN_B0; //Define buttonPin no pino B0 - botão dos pedestres



signed int8 flag=1;

byte const unidade[11]={
   0b11111110, //0
   0b00111000, //1
   0b11011101, //2
   0b01111101, //3
   0b00111011, //4
   0b01110111, //5
   0b11110111, //6
   0b00111100, //7
   0b11111111, //8
   0b01111111 //9
};

byte const dezena[11]={
   0b11101110, //0
   0b00101000, //1
   0b11001101, //2
   0b01101101, //3
   0b00101011, //4
   0b01100111, //5
   0b11100111, //6
   0b00101100, //7
   0b11101111, //8
   0b01101111 //9
};


void teste(){
   unsigned int i=0,tempo,cont = 25;
   for(tempo=0;tempo<100;tempo++){
         i = cont/10;
         output_b(dezena[i]);
         delay_ms(5);
         i = cont%10;
         output_b(unidade[i]);
         delay_ms(5);
      }
      cont=cont+flag;
      if(cont>=60 || cont<=25){
         flag=flag*(-1);
      }
}

const char table[16]={0x3F,0x06,0x5B,0x4F,0x66,0x6D,0x7D,0x7F,0x6F,0x77,0x7C,0x58,0x5E,0x79,0x71};

unsigned char display7s(unsigned char v)
{

  return table[v & 0x0F];
}


void main()
{
   setup_adc_ports(NO_ANALOGS);
   setup_adc(ADC_CLOCK_DIV_2);
   setup_psp(PSP_DISABLED);
   setup_spi(SPI_SS_DISABLED);
   setup_timer_0(RTCC_INTERNAL|RTCC_DIV_1);
   setup_timer_1(T1_DISABLED);
   setup_timer_2(T2_DISABLED,0,1);
   setup_comparator(NC_NC_NC_NC);
   setup_vref(FALSE);
   
   while(true){
      
unsigned char display7s(unsigned char v)
{
  switch(v)
  {
    case 0:
      return 0x3F;
    case 1:
      return 0x06;
    case 2:
      return 0x5B;
    case 3:
      return 0x4F;
    case 4:
      return 0x66;
    case 5:
      return 0x6D;
    case 6:
      return 0x7D;
    case 7:
      return 0x07;
    case 8:
      return 0x7F;
    case 9:
      return 0x6F;
    case 10:
      return 0x77;
    case 11:
      return 0x7c;
    case 12:
      return 0x58;
    case 13:
      return 0x5E;
    case 14:
      return 0x79;
    case 15:
      return 0x71;
    default:
      return 0;
  }
}

   }
   

}
